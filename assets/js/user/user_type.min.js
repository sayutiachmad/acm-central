var grid;var tbl=$("#table_for_data");var page_form=$("#mp_form");var validate_form;var notif_msg;jQuery(document).ready(function(a){grid=tbl.DataTable({responsive:false,rowReorder:true,ajax:{url:base_url+"user/get_user_type",},columns:[{data:null,defaultContent:"",width:"5%",searchable:false,orderable:false},{data:"type_name",width:"55%"},{data:null,defaultContent:"",width:"8%",orderable:false,searchable:false}],columnDefs:[{targets:2,render:function(d,c,f,e){var b="";b+='<div class="btn-group">';b+='<button type="button" class="btn btn-block btn-xs bg-blue dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">';b+='Options <span class="caret"></span>';b+="</button>";b+='<div class="dropdown-menu float-right">';b+='<a href="javascript:void(0);" class="dropdown-item action_edit"><i class="fa fa-edit"></i> Edit</a>';b+='<a href="javascript:void(0);" class="dropdown-item action_remove"><i class="fa fa-trash"></i> Delete</a>';b+="</div>";b+="</div>";return"<center>"+b+"</center>"}}],order:[[1,"asc"]]});grid.on("order.dt search.dt",function(){grid.column(0,{search:"applied",order:"applied"}).nodes().each(function(b,c){b.innerHTML=c+1})}).draw();a("#table_for_data tbody").on("click",".action_edit",function(){open_modal("Ubah User Type");a('[name="ut_name_"]').val(grid.row(a(this).parents("tr")).data().type_name);a('[name="ut_code_"]').val(grid.row(a(this).parents("tr")).data().id_user_type)});a("#table_for_data tbody").on("click",".action_remove",function(){remove_data(grid.row(a(this).parents("tr")).data().id_user_type)});validate_form=page_form.validate({rules:{ut_name_:"required"},messages:{ut_name_:"Field ini harus diisi"},highlight:function(b){a(b).parents(".form-line").addClass("error")},unhighlight:function(b){a(b).parents(".form-line").removeClass("error")},errorPlacement:function(b,c){a(c).parents(".form-group").append(b)},submitHandler:function(b){save_data()}});reloadTable();addForm()});function reloadTable(){$("#reload_table").click(function(a){grid.ajax.reload()})}function open_modal(a){$("#modal_label").html(a);$("#modal_form").modal({backdrop:"static",keyboard:false})}function addForm(){$("#action_add").click(function(a){$('[name="ut_code_"]').val("");page_form[0].reset();open_modal("User Type Baru")})}function save_data(){var a=page_form.serialize();$("#btn_submit").html("Processing...").attr("disabled","true");$("#modal_preloader").show("fast");$.ajax({url:base_url+"user/save_user_type",type:"POST",data:a}).done(function(c){var b=JSON.parse(c);if(b.result){notif_msg="Berhasil menyimpan data!";showNotification("bg-green",notif_msg,"top","right",null,null);page_form.get(0).reset();$("#modal_form").modal("toggle");grid.ajax.reload()}else{notif_msg="Oops! Gagal menyimpan data!";showNotification("alert-danger",notif_msg,"top","right",null,null)}}).fail(function(){notif_msg="Oops! Terjadi kesalahan saat megirim data";showNotification("alert-danger",notif_msg,"top","right",null,null)}).always(function(){$("#btn_submit").html("SIMPAN").removeAttr("disabled");$("#modal_preloader").hide("fast")})}function remove_data(a){$.confirm({title:"Konfirmasi",content:"Hapus User Type?",type:"red",buttons:{remove:{text:"HAPUS",btnClass:"btn-danger",action:function(){$.alert({type:"orange",buttons:{close:{btnClass:"btn-primary"}},content:function(){var b=this;return $.ajax({url:base_url+"user/remove_user_type",type:"POST",data:{ut_code_:a}}).done(function(d){var c=JSON.parse(d);b.setContent(c.msg);b.setTitle("Hapus User Type");grid.ajax.reload()}).fail(function(){b.setContent("Oops, terjadi kesalahan!")})}})}},cancel:function(){},}})};